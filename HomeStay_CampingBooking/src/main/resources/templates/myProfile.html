<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>MyProfile</title>
  <link rel="stylesheet" type="text/css" href="/header.css">
  <link rel="stylesheet" type="text/css" href="/myProfile.css">

</head>
<body>
<nav>
  <div class="nav-container">
    <div class="logo">Homestay & Camping</div>
    <div class="nav-links">
      <a href="/" class="active">Trang Chá»§</a>
      <a href="About">Giá»›i Thiá»‡u</a>
      <a href="services">Dá»‹ch Vá»¥</a>
      <a href="support">Há»— Trá»£</a>
      <a href="bookedroom">Äáº·t Chá»—</a>
      <th:block th:if="${session.loggedInUser}">
        <a href="/profile">Trang CÃ¡ NhÃ¢n</a>
        <form action="login/logout" method="post" style="display:inline;">
          <button type="submit">ÄÄƒng Xuáº¥t</button>
        </form>
      </th:block>

      <!-- Náº¿u chÆ°a Ä‘Äƒng nháº­p -->
      <th:block th:unless="${session.loggedInUser}">
        <a href="/login">ÄÄƒng Nháº­p</a>
        <a href="/register">ÄÄƒng KÃ½</a>
      </th:block>
    </div>
    <div class="language-dropdown">
      <select>
        <option value="vi">Viá»‡t Nam</option>
        <option value="en">English</option>
      </select>
    </div>
  </div>
</nav>
<main style="margin-top: 80px;">
  <h2 style="text-align: center; color: #333;">ThÃ´ng Tin CÃ¡ NhÃ¢n</h2>
  <div class="profile-container">
    <th:block th:if="${session.loggedInUser}">
      <img class="profile-avatar" src="/images/Background.jpg" alt="áº¢nh Ä‘áº¡i diá»‡n">
      <div class="profile-info">
        <p><strong>ğŸ‘¤ Username:</strong> <span th:text="${session.loggedInUser.username}"></span></p>
        <p><strong>ğŸ­ Vai trÃ²:</strong> <span th:text="${session.loggedInUser.role}"></span></p>
      </div>
      <!-- NÃºt báº­t form: dÃ¹ng label Ä‘á»ƒ kiá»ƒm soÃ¡t checkbox -->
      <label for="toggleEdit" class="btn-edit">Chá»‰nh sá»­a thÃ´ng tin</label>

      <!-- Checkbox áº©n Ä‘á»ƒ báº­t/táº¯t modal -->
      <input type="checkbox" id="toggleEdit" hidden>

      <div class="modal">
        <div class="modal-content">
          <label for="toggleEdit" class="close-btn">&times;</label>
          <h3>Chá»‰nh sá»­a thÃ´ng tin</h3>
          <form action="/edit-profile" method="post">
            <label><strong>ğŸ‘¤ Username:</strong></label>
            <input type="text" name="username" th:value="${session.loggedInUser.username}" required>

            <label><strong>ğŸ”‘ Máº­t kháº©u má»›i:</strong></label>
            <input type="password" name="password" required>

            <label><strong>ğŸ”‘ Máº­t kháº©u cÅ©:</strong></label>
            <input type="password" name="confirmPassword" required>

            <div class="button-group">
              <label for="toggleEdit" class="btn-edit cancel-btn">Há»§y</label>
              <button type="submit" class="btn-edit">LÆ°u thay Ä‘á»•i</button>
            </div>
          </form>
        </div>
      </div>

      <h3>Danh sÃ¡ch Homestay Ä‘Ã£ Ä‘áº·t:</h3>
      <th:block th:if="${#lists.isEmpty(bookedRooms)}">
        <p style="color: gray;">ChÆ°a cÃ³ phÃ²ng nÃ o Ä‘Æ°á»£c Ä‘áº·t.<a href="bookedroom">Äáº·t phÃ²ng ngay!</a></p>
      </th:block>
      <th:block th:unless="${#lists.isEmpty(bookedRooms)}">
        <table>
          <thead>
          <tr>
            <th>TÃªn khÃ¡ch</th>
            <th>Sá»‘ Ä‘iá»‡n thoáº¡i</th>
            <th>Loáº¡i phÃ²ng</th>
            <th>Vá»‹ trÃ­</th>
            <th>NgÃ y Ä‘áº¿n</th>
            <th>NgÃ y Ä‘i</th>
            <th>GiÃ¡</th>
          </tr>
          </thead>
          <tbody>
          <tr th:each="room : ${bookedRooms}">
            <td th:text="${room.guestName}"></td>
            <td th:text="${room.guestPhone}"></td>
            <td th:text="${room.homeStay.roomType}"></td>
            <td th:text="${room.homeStay.location}"></td>
            <td th:text="${room.checkInDate}"></td>
            <td th:text="${room.checkOutDate}"></td>
            <td th:text="${room.homeStay.roomPrice}"></td>
          </tr>
          </tbody>
        </table>
      </th:block>
      <h3>Dá»‹ch vá»¥ Ä‘Ã£ Ä‘áº·t:</h3>

      <th:block th:if="${#lists.isEmpty(bookedServices)}">
        <p style="color: gray;">ChÆ°a cÃ³ dá»‹ch vá»¥ nÃ o Ä‘Æ°á»£c Ä‘áº·t. <a href="/services">Äáº·t dá»‹ch vá»¥ ngay!</a></p>
      </th:block>

      <th:block th:unless="${#lists.isEmpty(bookedServices)}">
        <table>
          <thead>
          <tr>
            <th>TÃªn dá»‹ch vá»¥</th>
            <th>GiÃ¡</th>
            <th>MÃ´ táº£</th>
            <th>Thá»i gian</th>
          </tr>
          </thead>
          <tbody>
          <tr th:each="booked : ${bookedServices}">
            <td th:text="${booked.service.serviceName}"></td>
            <td th:text="${booked.service.servicePrice} + ' VNÄ'"></td>
            <td th:text="${booked.service.serviceDescription}"></td>
            <td th:text="${booked.time}"></td>
          </tr>
          </tbody>
        </table>
      </th:block>
      <th:block th:if="${session.loggedInUser.role.toString() == 'admin'}">
      <div class="admin-panel">
          <h3 style="color: red;">ğŸ”§ Khu vá»±c quáº£n trá»‹</h3>
          <ul>
            <li><a href="managerbookedroom">Quáº£n lÃ½ Ä‘áº·t phÃ²ng</a></li>
            <li><a href="managerhomestay">Quáº£n lÃ½ Homestay</a></li>
            <li><a href="managerservice">Quáº£n lÃ½ dá»‹ch vá»¥</a></li>
            <li><a href="manageruser">Quáº£n lÃ½ ngÆ°á»i dÃ¹ng</a></li>
            <li><a href="managerbookedservice">Quáº£n lÃ½ Ä‘áº·t dá»‹ch vá»¥</a></li>
          </ul>
        </div>
      </th:block>
    </th:block>
    <th:block th:unless="${session.loggedInUser}">
      <p>Báº¡n chÆ°a Ä‘Äƒng nháº­p. <a href="/login">ÄÄƒng nháº­p</a></p>
    </th:block>
  </div>
</main>
</body>
</html>
